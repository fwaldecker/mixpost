import{u as M,i as V,q as N,h as w,o as f,w as e,a as t,A as X,k as r,t as s,b as o,v as q,a1 as S,a5 as E,D as A,ar as Y,c as T,m as R,y as Z,O as U,s as P,e as $,j as D,Q as F,F as L,d as ee,M as te,U as oe,g as se,r as ae,a8 as O}from"./app-C7yQ4yxP.js";import{u as ne}from"./useSelectable-D4eEjBj_.js";import{_ as re}from"./Minimal-Bp2gpLcE.js";import{_ as le}from"./PageHeader-L61bBZJ1.js";import{_ as H}from"./Flex-B0LjVlwe.js";import{T as Q}from"./Trash-TUAkcl9a.js";import{_ as W}from"./PureDangerButton-CTpho9ji.js";import{_ as ie}from"./SelectableBar-BMA_UiaG.js";import{_ as ce}from"./Panel-DHnLtGhx.js";import{_,a as z,T as de}from"./TableCell-Do7VWhok.js";import{_ as j}from"./Checkbox-hSITjV1n.js";import{_ as ue}from"./NoResult-BiKMAkVj.js";import{u as G}from"./useRouter-CKabqmxS.js";import{u as me}from"./useAPIForm-B0dyKPRx.js";import{_ as I}from"./VerticalGroup-bCSYX3yy.js";import{_ as B}from"./LabelSuffix-CW5l7-lp.js";import{_ as _e}from"./Alert-nkqBEIg3.js";import{_ as fe}from"./Select-DMzj8fYH.js";import{_ as pe}from"./ClipboardCard-BnkRhqf1.js";import{_ as ke}from"./SuccessButton-BSd6uewq.js";import{_ as $e}from"./Pagination-xEfeiBk8.js";import{_ as ve}from"./BackToDashboardButton-BTfZrAK0.js";import"./ClipboardButton-CuDv6fEO.js";import"./Clipboard-C4EFUpKL.js";import"./ChevronLeft-Dhng4OHZ.js";import"./ArrowLeft-sxSHzSYs.js";const ge={__name:"TokenItem",props:{item:{type:Object,required:!0}},setup(c){const{t:l}=M(),h=V("routePrefix"),C=V("confirmation"),v=c,{onError:d}=G(),a=()=>{C().title(l("access_token.delete")).description(l("access_token.delete_confirm")).destructive().onConfirm(u=>{g(u)}).show()},g=u=>{u.isLoading(!0),S.delete(route(`${h}.profile.accessTokens.delete`,{token:v.item.id}),{onSuccess(){u.reset(),E.emit("tokenDelete",v.item.id)},onError(y){d(y,()=>{g(u)})},onFinish(){u.isLoading(!1)}})};return(u,y)=>{const b=N("tooltip");return f(),w(z,{hoverable:!0},{default:e(()=>[t(_,{class:"w-10"},{default:e(()=>[X(u.$slots,"checkbox")]),_:3}),t(_,null,{default:e(()=>[r(s(c.item.name),1)]),_:1}),t(_,null,{default:e(()=>[r(s(c.item.last_used_at?c.item.last_used_at:o(l)("access_token.never_used")),1)]),_:1}),t(_,null,{default:e(()=>[r(s(c.item.expires_at),1)]),_:1}),t(_,null,{default:e(()=>[r(s(c.item.created_at),1)]),_:1}),t(_,null,{default:e(()=>[q((f(),w(W,{onClick:a},{default:e(()=>[t(Q,{class:"w-5! h-5!"})]),_:1})),[[b,o(l)("general.delete")]])]),_:1})]),_:3})}}},he={for:"token_name"},ye={for:"expiration"},be={value:"days-7"},xe={value:"days-30"},Ce={value:"days-60"},we={value:"days-90"},Te={value:"never-expires"},Ve={value:"custom"},Se={__name:"CreateUserToken",emits:["added"],setup(c,{emit:l}){const h=V("routePrefix"),C=l,v=A(!1),d=A(""),a=me({name:"",expiration:"days-7",expires_at:""}),g=()=>{v.value=!0},u=()=>{v.value=!1,a.reset(),a.clearErrors()},{onCatch:y}=Y(),b=()=>{a.post(route(`${h}.profile.accessTokens.store`),{onSuccess(n){u(),a.reset(),d.value=n.plain_text_token,C("added")},onError(n){y(n,b)}})};return(n,i)=>(f(),T(L,null,[t(R,{onClick:g},{default:e(()=>[r(s(n.$t("access_token.create")),1)]),_:1}),t(F,{show:v.value,"max-width":"md",closeable:!0,"scrollable-body":!0,onClose:u},{header:e(()=>[r(s(n.$t("access_token.create")),1)]),body:e(()=>[t(I,null,{title:e(()=>[$("label",he,[r(s(n.$t("general.name"))+" ",1),t(B,{danger:!0},{default:e(()=>i[5]||(i[5]=[r("*")])),_:1})])]),footer:e(()=>[t(P,{message:o(a).errors.name},null,8,["message"])]),default:e(()=>[t(U,{type:"text",modelValue:o(a).name,"onUpdate:modelValue":i[0]||(i[0]=p=>o(a).name=p),error:o(a).errors.name!==void 0,id:"token_name",placeholder:n.$t("access_token.name_placeholder")},null,8,["modelValue","error","placeholder"])]),_:1}),t(I,{class:"mt-lg"},{title:e(()=>[$("label",ye,[r(s(n.$t("access_token.expiration"))+" ",1),t(B,{danger:!0},{default:e(()=>i[6]||(i[6]=[r("*")])),_:1})])]),footer:e(()=>[t(P,{message:o(a).errors.expiration},null,8,["message"]),t(P,{message:o(a).errors.expires_at},null,8,["message"])]),default:e(()=>[t(H,{class:"w-full"},{default:e(()=>[t(fe,{modelValue:o(a).expiration,"onUpdate:modelValue":i[1]||(i[1]=p=>o(a).expiration=p),error:o(a).errors.expiration!==void 0,id:"expiration"},{default:e(()=>[$("option",be,s(n.$t("calendar.days",{count:7})),1),$("option",xe,s(n.$t("calendar.days",{count:30})),1),$("option",Ce,s(n.$t("calendar.days",{count:60})),1),$("option",we,s(n.$t("calendar.days",{count:90})),1),$("option",Te,s(n.$t("access_token.never_expires")),1),$("option",Ve,s(n.$t("general.custom")),1)]),_:1},8,["modelValue","error"]),o(a).expiration==="custom"?(f(),w(U,{key:0,type:"date",modelValue:o(a).expires_at,"onUpdate:modelValue":i[2]||(i[2]=p=>o(a).expires_at=p),error:o(a).errors.expires_at,id:"expiration"},null,8,["modelValue","error"])):D("",!0)]),_:1})]),_:1})]),footer:e(()=>[t(Z,{onClick:u,class:"mr-xs"},{default:e(()=>[r(s(n.$t("general.cancel")),1)]),_:1}),t(R,{onClick:b,disabled:o(a).processing,isLoading:o(a).processing},{default:e(()=>[r(s(n.$t("general.create")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"]),t(F,{show:d.value!=="","max-width":"xl",closeable:!0,"scrollable-body":!0,onClose:i[4]||(i[4]=p=>d.value="")},{header:e(()=>[r(s(n.$t("access_token.create")),1)]),body:e(()=>[d.value?(f(),T(L,{key:0},[t(_e,{variant:"warning",closeable:!1},{default:e(()=>[r(s(n.$t("access_token.copy_token")),1)]),_:1}),t(pe,{class:"mt-lg"},{default:e(()=>[r(s(d.value),1)]),_:1})],64)):D("",!0)]),footer:e(()=>[t(ke,{onClick:i[3]||(i[3]=p=>d.value="")},{default:e(()=>[r(s(n.$t("system.stored_safely")),1)]),_:1})]),_:1},8,["show"])],64))}},De={class:"row-py w-full mx-auto pt-0!"},Le={key:0,class:"mt-lg"},Pe=ee({layout:re}),at=Object.assign(Pe,{__name:"AccessTokens",props:["tokens"],setup(c){const{t:l}=M(),h=c,C=V("routePrefix"),v=V("confirmation"),{selectedRecords:d,putPageRecords:a,toggleSelectRecordsOnPage:g,deselectRecord:u,deselectAllRecords:y}=ne(),b=()=>h.tokens.data.map(m=>m.id);te(()=>{a(b()),E.on("tokenDelete",m=>{u(m)})}),oe(()=>h.tokens.data,()=>{a(b())});const{onError:n}=G(),i=()=>{v().title(l("access_token.delete_items")).description(l("access_token.delete_items_confirm")).destructive().onConfirm(m=>{m.isLoading(!0),S.delete(route(`${C}.profile.accessTokens.deleteMultiple`),{data:{tokens:d.value},preserveScroll:!0,onSuccess(){m.reset(),y()},onError(k){n(k,()=>{p(m)})},onFinish(){m.isLoading(!1)}})}).show()},p=m=>{m.isLoading(!0),S.delete(route(`${C}.profile.accessTokens.deleteMultiple`),{data:{tokens:d.value},preserveScroll:!0,onSuccess(){m.reset(),E.emit("tokenDelete",h.item.id)},onError(k){n(k,()=>{p(m)})},onFinish(){m.isLoading(!1)}})};return(m,k)=>{const J=N("tooltip");return f(),T(L,null,[t(o(se),{title:o(l)("access_token.access_tokens")},null,8,["title"]),t(le,{title:o(l)("access_token.access_tokens"),class:"px-0!"},{description:e(()=>[r(s(o(l)("access_token.desc")),1)]),default:e(()=>[t(ve)]),_:1},8,["title"]),$("div",De,[t(ie,{count:o(d).length,onClose:o(y)},{default:e(()=>[q((f(),w(W,{onClick:i},{default:e(()=>[t(Q)]),_:1})),[[J,o(l)("general.delete")]])]),_:1},8,["count","onClose"]),t(H,null,{default:e(()=>[t(Se,{onAdded:k[0]||(k[0]=x=>o(S).get(m.route("mixpost.profile.accessTokens.index"),{},{only:["tokens"],preserveState:!0,preserveScroll:!0}))})]),_:1}),t(ce,{"with-padding":!1,class:"mt-lg"},{default:e(()=>[t(de,null,{head:e(()=>[t(z,null,{default:e(()=>[t(_,{component:"th",scope:"col",class:"w-10"},{default:e(()=>[t(j,{checked:o(g),"onUpdate:checked":k[1]||(k[1]=x=>O(g)?g.value=x:null),disabled:!c.tokens.data.length},null,8,["checked","disabled"])]),_:1}),t(_,{component:"th",scope:"col"},{default:e(()=>[r(s(o(l)("general.name")),1)]),_:1}),t(_,{component:"th",scope:"col"},{default:e(()=>[r(s(o(l)("access_token.last_usage")),1)]),_:1}),t(_,{component:"th",scope:"col"},{default:e(()=>[r(s(o(l)("access_token.expires_at")),1)]),_:1}),t(_,{component:"th",scope:"col"},{default:e(()=>[r(s(o(l)("general.created_at")),1)]),_:1}),t(_,{component:"th",scope:"col"})]),_:1})]),body:e(()=>[(f(!0),T(L,null,ae(c.tokens.data,x=>(f(),w(ge,{key:x.id,item:x,onOnDelete:()=>{o(u)(x.id)}},{checkbox:e(()=>[t(j,{checked:o(d),"onUpdate:checked":k[2]||(k[2]=K=>O(d)?d.value=K:null),value:x.id},null,8,["checked","value"])]),_:2},1032,["item","onOnDelete"]))),128))]),_:1}),c.tokens.data.length?D("",!0):(f(),w(ue,{key:0,class:"p-md"},{default:e(()=>[r(s(o(l)("access_token.no_result")),1)]),_:1}))]),_:1}),c.tokens.meta.links.length>3?(f(),T("div",Le,[t($e,{meta:c.tokens.meta,links:c.tokens.links},null,8,["meta","links"])])):D("",!0)])],64)}}});export{at as default};
