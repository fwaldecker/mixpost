import{u as I,c as p,o as i,a as s,F as b,r as P,h as x,s as O,w as e,e as r,j as y,t as o,k as n,b as t,_ as k,m as V,aq as ue,n as F,a6 as de,x as H,O as M,f as le,i as X,y as ae,Q as ce,D as h,H as fe,a7 as re,a3 as te,z as ne,A as G,a1 as me,d as _e,g as pe}from"./app-C7yQ4yxP.js";import{_ as ve}from"./Minimal-Bp2gpLcE.js";import{_ as N}from"./Radio-BputZrd1.js";import{_ as oe}from"./Select-DMzj8fYH.js";import{_ as T}from"./Flex-B0LjVlwe.js";import{_ as W}from"./InputHidden-DUFFO3NU.js";import{_ as ge}from"./Panel-DHnLtGhx.js";import{_ as E}from"./SectionBorder-BpV8jdd1.js";import{_ as we}from"./PageHeader-L61bBZJ1.js";import{u as $e}from"./useRouter-CKabqmxS.js";import{_ as he}from"./BackToDashboardButton-BTfZrAK0.js";import"./Eye-16K59JCb.js";import"./ArrowLeft-sxSHzSYs.js";const ye=["value"],be={key:0,class:"text-xs text-gray-500 mt-xs block"},ke={class:"font-medium"},xe=["label"],Ce=["value"],Ve={class:"flex items-center space-x-xs rtl:space-x-reverse"},Le={class:"flex items-center space-x-xs rtl:space-x-reverse"},Pe={__name:"Preferences",props:{form:{type:Object,require:!0},locales:{type:Array,required:!0},timezone_list:{type:Object,required:!0}},setup(u){const l=I(),{t:c}=l,a=u,v=$=>a.locales.find(m=>m.long===$).direction||"ltr",g=$=>!["en-GB","fr-CA","ar-SA","de-DE","es-MX"].includes($),{notify:f}=F(),d=()=>{a.form.put(route("mixpost.profile.updatePreferences"),{preserveScroll:!0,onSuccess(){ue.changeLocale(l,a.form.locale,v(a.form.locale)),f("success",c("profile.preferences_updated"))}})};return($,m)=>(i(),p("div",null,[(i(!0),p(b,null,P(u.form.errors,_=>(i(),x(O,{message:_,class:"mb-xs"},null,8,["message"]))),256)),s(k,null,{title:e(()=>[n(o(t(c)("general.language")),1)]),default:e(()=>[r("div",null,[s(oe,{modelValue:u.form.locale,"onUpdate:modelValue":m[0]||(m[0]=_=>u.form.locale=_)},{default:e(()=>[(i(!0),p(b,null,P(u.locales,_=>(i(),p("option",{value:_.long},o(_.english)+" - "+o(_.native)+" - ("+o(_.long)+") "+o(g(_.long)?"[Beta]":""),9,ye))),256))]),_:1},8,["modelValue"]),g(u.form.locale)?(i(),p("span",be,[m[6]||(m[6]=n(" ðŸš§ Language ")),r("span",ke,o(u.form.locale),1),m[7]||(m[7]=n(" is in beta and may not be fully translated or can contain errors. "))])):y("",!0)])]),_:1}),s(k,{class:"mt-lg"},{title:e(()=>[n(o(t(c)("general.timezone")),1)]),default:e(()=>[r("div",null,[s(oe,{modelValue:u.form.timezone,"onUpdate:modelValue":m[1]||(m[1]=_=>u.form.timezone=_)},{default:e(()=>[(i(!0),p(b,null,P(u.timezone_list,(_,L)=>(i(),p("optgroup",{label:L},[(i(!0),p(b,null,P(_,(S,U)=>(i(),p("option",{value:U},o(S),9,Ce))),256))],8,xe))),256))]),_:1},8,["modelValue"])])]),_:1}),s(k,{class:"mt-lg"},{title:e(()=>[n(o(t(c)("profile.time_format")),1)]),default:e(()=>[r("div",Ve,[r("label",null,[s(N,{checked:u.form.time_format,"onUpdate:checked":m[2]||(m[2]=_=>u.form.time_format=_),value:12},null,8,["checked"]),n(" 12 "+o(t(c)("profile.hour")),1)]),r("label",null,[s(N,{checked:u.form.time_format,"onUpdate:checked":m[3]||(m[3]=_=>u.form.time_format=_),value:24},null,8,["checked"]),n(" 24 "+o(t(c)("profile.hour")),1)])])]),_:1}),s(k,{class:"mt-lg"},{title:e(()=>[n(o(t(c)("profile.first_day_week")),1)]),default:e(()=>[r("div",Le,[r("label",null,[s(N,{checked:u.form.week_starts_on,"onUpdate:checked":m[4]||(m[4]=_=>u.form.week_starts_on=_),value:0},null,8,["checked"]),n(" "+o(t(c)("profile.sunday")),1)]),r("label",null,[s(N,{checked:u.form.week_starts_on,"onUpdate:checked":m[5]||(m[5]=_=>u.form.week_starts_on=_),value:1},null,8,["checked"]),n(" "+o(t(c)("profile.monday")),1)])])]),_:1}),s(V,{onClick:d,class:"mt-lg"},{default:e(()=>[n(o(t(c)("general.save")),1)]),_:1})]))}},Se={for:"name"},Ue={for:"email"},Ae={__name:"UserAccount",setup(u){const{t:l}=I(),{user:c}=de(),{notify:a}=F(),v=H({name:c.value.name,email:c.value.email}),g=()=>{v.put(route("mixpost.profile.updateUser"),{preserveScroll:!0,onSuccess(){a("success",l("account.account_updated"))}})};return(f,d)=>(i(),p("form",{onSubmit:le(g,["prevent"])},[(i(!0),p(b,null,P(t(v).errors,$=>(i(),x(O,{message:$,class:"mb-xs"},null,8,["message"]))),256)),s(k,null,{title:e(()=>[r("label",Se,o(t(l)("general.name")),1)]),default:e(()=>[s(M,{type:"text",modelValue:t(v).name,"onUpdate:modelValue":d[0]||(d[0]=$=>t(v).name=$),error:t(v).errors.name,id:"name"},null,8,["modelValue","error"])]),_:1}),s(k,{class:"mt-lg"},{title:e(()=>[r("label",Ue,o(t(l)("general.email")),1)]),default:e(()=>[s(M,{type:"email",modelValue:t(v).email,"onUpdate:modelValue":d[1]||(d[1]=$=>t(v).email=$),error:t(v).errors.email,id:"email"},null,8,["modelValue","error"])]),_:1}),s(V,{type:"submit",class:"mt-lg"},{default:e(()=>[n(o(t(l)("general.save")),1)]),_:1})],32))}},ze={for:"password"},Ie={__name:"ConfirmPassword",props:{show:{type:Boolean,default:!0}},emits:["close","confirm"],setup(u,{emit:l}){const c=X("routePrefix"),a=l,v=()=>{a("close")},g=H({password:""}),f=()=>{g.post(route(`${c}.profile.confirmPassword`),{preserveScroll:!0,onSuccess(){a("confirm"),g.reset(),v()}})};return(d,$)=>(i(),x(ce,{show:u.show,"max-width":"lg",closeable:!0,"scrollable-body":!0,zIndexClass:"z-30",onClose:v},{header:e(()=>[n(o(d.$t("auth.confirm_password")),1)]),body:e(()=>[u.show?(i(),p(b,{key:0},[r("div",null,o(d.$t("profile.security_confirm_password")),1),s(k,{class:"mt-lg"},{title:e(()=>[r("label",ze,o(d.$t("auth.password")),1)]),footer:e(()=>[s(O,{message:t(g).errors.password},null,8,["message"])]),default:e(()=>[s(M,{modelValue:t(g).password,"onUpdate:modelValue":$[0]||($[0]=m=>t(g).password=m),error:t(g).errors.password,type:"password",id:"password",class:"w-full",autocomplete:"password"},null,8,["modelValue","error"])]),_:1})],64)):y("",!0)]),footer:e(()=>[s(ae,{onClick:v,class:"mr-xs"},{default:e(()=>[n(o(d.$t("general.cancel")),1)]),_:1}),s(V,{onClick:f,disabled:t(g).processing,isLoading:t(g).processing,class:"mr-xs"},{default:e(()=>[n(o(d.$t("general.confirm")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"]))}},je={class:"mt-lg"},qe={key:0,class:"mt-lg"},Be=["innerHTML"],Re={class:"uppercase font-medium text-center"},De={class:"text-gray-500"},Ne={class:"mt-md"},Te={for:"code"},Ee={key:1},Me={key:0,class:"mt-lg"},Oe={class:"mt-xs bg-primary-50 rounded-lg p-md"},Fe={class:"mb-xs"},He={class:"font-medium"},Qe={__name:"TwoFactorAuth",setup(u){const{t:l}=I(),c=h({svg:"",secret_key:""}),a=h(!1),v=h(!1),g=h(""),f=h(!1),d=h(!1),$=h([]),m=h(!1),_=h(null),L=X("routePrefix"),{notify:S}=F(),U=fe(()=>v.value?!1:re().props.user_has_two_factor_auth_enabled||a.value===!0),ie=()=>{m.value=!0},J=()=>{m.value=!1},j=h(!1),K=()=>{j.value=!0,axios.post(route(`${L}.profile.two-factor-auth.enable`)).then(w=>{f.value=!0,c.value=w.data}).catch(w=>A(w,K)).finally(()=>j.value=!1)},q=h(!1),Y=()=>{q.value=!0,axios.post(route(`${L}.profile.two-factor-auth.confirm`),{code:g.value}).then(w=>{a.value=!0,v.value=!1,f.value=!1,$.value=w.data.recovery_codes,d.value=!0,g.value="",S("success",l("profile.two_factor_enabled"))}).catch(w=>A(w,Y)).finally(()=>q.value=!1)},B=h(!1),Z=()=>{B.value=!0,axios.get(route(`${L}.profile.two-factor-auth.showRecoveryCodes`)).then(w=>{$.value=w.data.recovery_codes,d.value=!0}).catch(w=>A(w,Z)).finally(()=>B.value=!1)},R=h(!1),ee=()=>{R.value=!0,axios.post(route(`${L}.profile.two-factor-auth.regenerateRecoveryCodes`)).then(w=>{$.value=w.data.recovery_codes,d.value=!0}).catch(w=>A(w,ee)).finally(()=>R.value=!1)},D=h(!1),se=()=>{D.value=!0,axios.delete(route(`${L}.profile.two-factor-auth.disable`)).then(()=>{v.value=!0,S("success",l("profile.two_factor_disabled"))}).catch(w=>A(w,se)).finally(()=>D.value=!1)},A=(w,C)=>{if(w.response.status===422){w.response.data.errors.confirm_password&&(_.value=C,ie()),w.response.data.errors.code&&S("error",w.response.data.errors.code[0]);return}S("error",l("error.something_wrong"))};return(w,C)=>(i(),p(b,null,[r("div",null,[r("div",null,o(t(l)("profile.install_totp")),1),r("div",je,[U.value?(i(),x(te,{key:0,variant:"success"},{default:e(()=>[n(o(t(l)("general.enabled")),1)]),_:1})):y("",!0),U.value?y("",!0):(i(),x(te,{key:1,variant:"error"},{default:e(()=>[n(o(t(l)("general.disabled")),1)]),_:1}))]),f.value?(i(),p("div",qe,[s(T,{class:"w-full relative rounded-lg border border-gray-200 p-xs"},{default:e(()=>[r("div",{innerHTML:c.value.svg},null,8,Be),s(T,{class:"justify-center items-center w-full"},{default:e(()=>[r("div",Re,[r("div",De,o(t(l)("profile.secret_key")),1),r("div",null,o(c.value.secret_key),1)])]),_:1})]),_:1}),r("div",Ne,o(t(l)("profile.scan_qr_code")),1),s(k,{class:"mt-lg"},{title:e(()=>[r("label",Te,o(t(l)("profile.code")),1)]),default:e(()=>[s(M,{modelValue:g.value,"onUpdate:modelValue":C[0]||(C[0]=Q=>g.value=Q),type:"text",id:"code",class:"w-full",autocomplete:"off"},null,8,["modelValue"])]),_:1}),s(T,null,{default:e(()=>[s(V,{onClick:Y,disabled:q.value,isLoading:q.value,class:"mt-lg"},{default:e(()=>[n(o(t(l)("general.confirm")),1)]),_:1},8,["disabled","isLoading"]),s(ae,{onClick:C[1]||(C[1]=()=>{f.value=!1,g.value=""}),class:"mt-lg"},{default:e(()=>[n(o(t(l)("general.cancel")),1)]),_:1})]),_:1})])):y("",!0),U.value?(i(),p("div",Ee,[d.value?(i(),p("div",Me,[r("div",null,o(t(l)("profile.store_recovery_codes")),1),r("div",Oe,[(i(!0),p(b,null,P($.value,Q=>(i(),p("div",Fe,[r("div",He,o(Q),1)]))),256))])])):y("",!0),s(T,{class:"mt-lg"},{default:e(()=>[d.value?(i(),x(V,{key:0,onClick:ee,disabled:R.value,isLoading:R.value},{default:e(()=>[n(o(t(l)("profile.regenerate_recovery_codes")),1)]),_:1},8,["disabled","isLoading"])):y("",!0),d.value?y("",!0):(i(),x(V,{key:1,onClick:Z,disabled:B.value,isLoading:B.value},{default:e(()=>[n(o(t(l)("profile.show_recovery_codes")),1)]),_:1},8,["disabled","isLoading"])),s(ne,{onClick:se,disabled:D.value,isLoading:D.value},{default:e(()=>[n(o(t(l)("general.disable")),1)]),_:1},8,["disabled","isLoading"])]),_:1})])):y("",!0),!U.value&&!f.value?(i(),x(V,{key:2,onClick:K,disabled:j.value,isLoading:j.value,class:"mt-lg"},{default:e(()=>[n(o(t(l)("general.enable")),1)]),_:1},8,["disabled","isLoading"])):y("",!0)]),s(Ie,{show:m.value,onConfirm:C[2]||(C[2]=()=>{J(),_.value&&_.value()}),onClose:J},null,8,["show"])],64))}},Ge={for:"current_password"},We={for:"password"},Xe={for:"password_confirmation"},Je={__name:"Password",setup(u){const{t:l}=I(),{notify:c}=F(),a=H({current_password:"",password:"",password_confirmation:""}),v=()=>{a.put(route("mixpost.profile.updatePassword"),{preserveScroll:!0,onSuccess(){a.reset(),c("success",l("profile.password_changed"))}})};return(g,f)=>(i(),p("form",{onSubmit:le(v,["prevent"])},[(i(!0),p(b,null,P(t(a).errors,d=>(i(),x(O,{message:d,class:"mb-xs"},null,8,["message"]))),256)),s(k,{class:"mt-lg"},{title:e(()=>[r("label",Ge,o(t(l)("profile.current_password")),1)]),default:e(()=>[s(W,{modelValue:t(a).current_password,"onUpdate:modelValue":f[0]||(f[0]=d=>t(a).current_password=d),error:t(a).errors.current_password,id:"current_password",required:""},null,8,["modelValue","error"])]),_:1}),s(k,{class:"mt-md"},{title:e(()=>[r("label",We,o(t(l)("profile.new_password")),1)]),default:e(()=>[s(W,{modelValue:t(a).password,"onUpdate:modelValue":f[1]||(f[1]=d=>t(a).password=d),error:t(a).errors.password,id:"password",autocomplete:"new-password",required:""},null,8,["modelValue","error"])]),_:1}),s(k,{class:"mt-md"},{title:e(()=>[r("label",Xe,o(t(l)("profile.confirm_new_password")),1)]),default:e(()=>[s(W,{modelValue:t(a).password_confirmation,"onUpdate:modelValue":f[2]||(f[2]=d=>t(a).password_confirmation=d),error:t(a).password_confirmationpassword,id:"password_confirmation",autocomplete:"new-password",required:""},null,8,["modelValue","error"])]),_:1}),s(V,{type:"submit",class:"mt-lg"},{default:e(()=>[n(o(t(l)("general.save")),1)]),_:1})],32))}},Ke={class:"md:grid md:grid-cols-3 md:gap-lg"},Ye={class:"md:col-span-1 flex justify-between"},Ze={class:"text-lg font-medium text-gray-900"},es={class:"mt-xs text-gray-500"},ss={class:"mt-lg md:mt-0 md:col-span-2"},z={__name:"ActionSection",setup(u){return(l,c)=>(i(),p("div",Ke,[r("div",Ye,[r("div",null,[r("h3",Ze,[G(l.$slots,"title")]),r("p",es,[G(l.$slots,"description")])])]),r("div",ss,[s(ge,null,{default:e(()=>[G(l.$slots,"default")]),_:3})])]))}},ts={__name:"DeleteAccount",setup(u){const{t:l}=I(),c=X("confirmation"),{onError:a}=$e(),v=()=>{c().title(l("profile.delete_account")).description(l("profile.delete_account_desc")).destructive().btnConfirmName(l("profile.delete_account")).onConfirm(f=>{f.isLoading(!0),g(f)}).show()},g=f=>{me.delete(re().props.delete_account_url,{onSuccess(){f.reset()},onError(d){f.isLoading(!1),a(d,()=>{f.isLoading(!0),g(f)})}})};return(f,d)=>(i(),x(ne,{onClick:v},{default:e(()=>[n(o(t(l)("profile.delete_account")),1)]),_:1}))}},os={class:"row-py w-full mx-auto pt-0!"},ls={class:"w-full mb-lg"},as={class:"mt-2xl sm:mt-0"},rs={class:"mt-2xl sm:mt-0"},ns={class:"mt-2xl sm:mt-0"},is={class:"mt-2xl sm:mt-0"},us={class:"mt-2xl sm:mt-0"},ds=_e({layout:ve}),xs=Object.assign(ds,{__name:"Profile",props:["settings","locales","timezone_list","user_has_two_factor_auth_enabled","is_delete_account_enabled"],setup(u){const c=H(u.settings);return(a,v)=>(i(),p(b,null,[s(t(pe),{title:a.$t("profile.edit_profile")},null,8,["title"]),s(we,{title:a.$t("profile.edit_profile"),class:"px-0!"},{default:e(()=>[s(he)]),_:1},8,["title"]),r("div",os,[r("div",ls,[r("div",as,[s(z,null,{title:e(()=>[n(o(a.$t("profile.profile_information")),1)]),description:e(()=>[n(o(a.$t("profile.update_your_account")),1)]),default:e(()=>[s(Ae)]),_:1})]),s(E,{contrasted:!0}),r("div",rs,[s(z,null,{title:e(()=>[n(o(a.$t("profile.preferences")),1)]),description:e(()=>[n(o(a.$t("profile.update_preferences")),1)]),default:e(()=>[s(Pe,{form:t(c),timezone_list:u.timezone_list,locales:u.locales},null,8,["form","timezone_list","locales"])]),_:1})]),a.$page.props.is_two_factor_auth_enabled?(i(),p(b,{key:0},[s(E,{contrasted:!0}),r("div",ns,[s(z,null,{title:e(()=>[n(o(a.$t("auth.two_factor_authentication")),1)]),description:e(()=>[n(o(a.$t("auth.security_using_two_factor")),1)]),default:e(()=>[s(Qe)]),_:1})])],64)):y("",!0),s(E,{contrasted:!0}),r("div",is,[s(z,null,{title:e(()=>[n(o(a.$t("auth.update_password")),1)]),description:e(()=>[n(o(a.$t("auth.confirm_secure_password")),1)]),default:e(()=>[s(Je)]),_:1})]),u.is_delete_account_enabled?(i(),p(b,{key:1},[s(E,{contrasted:!0}),r("div",us,[s(z,null,{title:e(()=>[n(o(a.$t("profile.delete_account")),1)]),description:e(()=>[n(o(a.$t("profile.delete_account_desc")),1)]),default:e(()=>[s(ts)]),_:1})])],64)):y("",!0)])])],64))}});export{xs as default};
