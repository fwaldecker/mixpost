import{u as B,i as x,a6 as F,D as A,q as E,c as v,o,e as V,v as L,a as e,b as s,h as p,w as t,j as I,V as P,k as m,t as i,a0 as J,W as K,a1 as j,a5 as C,A as Q,aa as X,a3 as Y,H as Z,d as ee,M as te,T as se,U as T,l as U,g as ae,S as le,m as re,F as N,r as oe,a8 as R,n as ne}from"./app-C7yQ4yxP.js";import{_ as ie}from"./Admin-2kdh7iq6.js";import{u as ue}from"./useSelectable-D4eEjBj_.js";import{_ as ce}from"./PageHeader-L61bBZJ1.js";import{_ as de}from"./PureDangerButton-CTpho9ji.js";import{_ as me}from"./Panel-DHnLtGhx.js";import{_ as q}from"./Checkbox-hSITjV1n.js";import{_ as n,a as M,T as fe}from"./TableCell-Do7VWhok.js";import{_ as _e}from"./PureButtonLink-PaYLzY0E.js";import{E as pe}from"./Eye-16K59JCb.js";import{T as W}from"./Trash-TUAkcl9a.js";import{_ as he}from"./DropdownButton-DdQamZC7.js";import{_ as $e}from"./SelectableBar-BMA_UiaG.js";import{_ as ve}from"./NoResult-BiKMAkVj.js";import{_ as ge}from"./Pagination-xEfeiBk8.js";import{_ as ke}from"./SearchInput-C73xFZvN.js";import{_ as be}from"./Flex-B0LjVlwe.js";import"./QueueList-DM6iDr1_.js";import"./EllipsisVertical-Cfd6Agro.js";import"./ChevronLeft-Dhng4OHZ.js";const ye={class:"flex flex-row items-center justify-end gap-xs"},we={__name:"UserItemAction",props:{itemId:{type:Number,required:!0}},emits:["onDelete"],setup(a,{emit:l}){const{t:r}=B(),u=x("routePrefix"),h=x("confirmation"),g=a,D=l,{user:k}=F(),_=A(!1),b=()=>{h().title(r("user.delete_user")).description(r("user.confirm_delete_user")).destructive().onConfirm(c=>{c.isLoading(!0),j.delete(route(`${u}.users.delete`,{user:g.itemId}),{onSuccess(){_.value=!1,D("onDelete"),C.emit("userDelete",g.itemId),c.reset()},onFinish(){c.close()}})}).show()};return(c,S)=>{const y=E("tooltip");return o(),v("div",null,[V("div",ye,[L((o(),p(_e,{href:c.route(`${s(u)}.users.view`,{user:a.itemId})},{default:t(()=>[e(pe)]),_:1},8,["href"])),[[y,s(r)("general.view")]]),e(K,{placement:"bottom-end"},{trigger:t(()=>[e(he)]),content:t(()=>[e(P,{href:c.route(`${s(u)}.users.edit`,{user:a.itemId})},{icon:t(()=>[e(J)]),default:t(()=>[m(" "+i(s(r)("general.edit")),1)]),_:1},8,["href"]),s(k).id!==a.itemId?(o(),p(P,{key:0,onClick:b,as:"button"},{icon:t(()=>[e(W,{class:"text-red-500"})]),default:t(()=>[m(" "+i(s(r)("general.delete")),1)]),_:1})):I("",!0)]),_:1})])])}}},xe={__name:"UserItem",props:{item:{type:Object,required:!0}},setup(a){return(l,r)=>(o(),p(M,{hoverable:!0},{default:t(()=>[e(n,{class:"w-10"},{default:t(()=>[Q(l.$slots,"checkbox")]),_:3}),e(n,null,{default:t(()=>[e(X,{name:a.item.name},null,8,["name"])]),_:1}),e(n,null,{default:t(()=>[V("div",null,i(a.item.name),1),a.item.is_admin?(o(),p(Y,{key:0,class:"mt-xs"},{default:t(()=>[m(i(l.$t("user.system_admin")),1)]),_:1})):I("",!0)]),_:1}),e(n,null,{default:t(()=>[m(i(a.item.email),1)]),_:1}),e(n,null,{default:t(()=>[m(i(a.item.created_at),1)]),_:1}),e(n,null,{default:t(()=>[e(we,{itemId:a.item.id},null,8,["itemId"])]),_:1})]),_:3}))}},Ve={class:"flex items-center"},Ie={__name:"Filters",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(a,{emit:l}){return Z(()=>0),(r,u)=>(o(),v("div",Ve,[e(ke,{modelValue:a.modelValue.keyword,"onUpdate:modelValue":u[0]||(u[0]=h=>a.modelValue.keyword=h),placeholder:r.$t("general.search")},null,8,["modelValue","placeholder"])]))}},De={class:"w-full mx-auto row-py"},Se={class:"mt-lg row-px w-full"},Ue={key:0,class:"mt-lg"},je=ee({layout:ie}),Xe=Object.assign(je,{__name:"Users",props:{users:{type:Object},filter:{type:Object,default:{}}},setup(a){const{t:l}=B(),r=x("routePrefix"),u=a,h=l("user.users"),{notify:g}=ne(),D=x("confirmation"),{user:k}=F(),{selectedRecords:_,putPageRecords:b,toggleSelectRecordsOnPage:c,deselectRecord:S,deselectAllRecords:y}=ue(),O=()=>u.users.data.filter(d=>d.id!==k.value.id).map(d=>d.id),w=A({keyword:u.filter.keyword});te(()=>{b(O()),C.on("userDelete",d=>{S(d)})}),se(()=>{C.off("userDelete")}),T(()=>u.users.data,()=>{b(O())}),T(()=>U.cloneDeep(w.value),U.throttle(()=>{j.get(route(`${r}.users.index`),U.pickBy(w.value),{preserveState:!0,only:["users","filter"]})},300));const H=()=>{D().title(l("user.delete_users")).description(l("user.confirm_delete_users")).destructive().onConfirm(d=>{d.isLoading(!0),j.delete(route(`${r}.users.deleteMultiple`),{data:{users:_.value},preserveScroll:!0,onSuccess(){y(),g("success",l("user.selected_users_deleted"))},onFinish(){d.reset()}})}).show()};return(d,$)=>{const z=E("tooltip");return o(),v(N,null,[e(s(ae),{title:s(h)},null,8,["title"]),V("div",De,[e(ce,{title:s(h)},{description:t(()=>[m(i(s(l)("user.manage_users")),1)]),_:1},8,["title"]),V("div",Se,[e($e,{count:s(_).length,onClose:s(y)},{default:t(()=>[L((o(),p(de,{onClick:H},{default:t(()=>[e(W)]),_:1})),[[z,s(l)("general.delete")]])]),_:1},8,["count","onClose"]),e(be,{class:"justify-between"},{default:t(()=>[e(s(le),{href:d.route(`${s(r)}.users.create`),class:"mb-xs sm:mb-0"},{default:t(()=>[e(re,null,{default:t(()=>[m(i(s(l)("user.create_user")),1)]),_:1})]),_:1},8,["href"]),e(Ie,{modelValue:w.value,"onUpdate:modelValue":$[0]||($[0]=f=>w.value=f)},null,8,["modelValue"])]),_:1}),e(me,{"with-padding":!1,class:"mt-lg"},{default:t(()=>[e(fe,null,{head:t(()=>[e(M,null,{default:t(()=>[e(n,{component:"th",scope:"col",class:"w-10"},{default:t(()=>[e(q,{checked:s(c),"onUpdate:checked":$[1]||($[1]=f=>R(c)?c.value=f:null),disabled:!a.users.meta.total},null,8,["checked","disabled"])]),_:1}),e(n,{component:"th",scope:"col"}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(s(l)("general.name")),1)]),_:1}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(s(l)("general.email")),1)]),_:1}),e(n,{component:"th",scope:"col"},{default:t(()=>[m(i(s(l)("general.created_at")),1)]),_:1}),e(n,{component:"th",scope:"col"})]),_:1})]),body:t(()=>[(o(!0),v(N,null,oe(a.users.data,f=>(o(),p(xe,{key:f.id,item:f,onOnDelete:()=>{s(S)(f.id)}},{checkbox:t(()=>[e(q,{checked:s(_),"onUpdate:checked":$[2]||($[2]=G=>R(_)?_.value=G:null),value:f.id,disabled:f.id===s(k).id,number:""},null,8,["checked","value","disabled"])]),_:2},1032,["item","onOnDelete"]))),128))]),_:1}),a.users.meta.total?I("",!0):(o(),p(ve,{key:0,table:""}))]),_:1}),a.users.meta.links.length>3?(o(),v("div",Ue,[e(ge,{meta:a.users.meta,links:a.users.links},null,8,["meta","links"])])):I("",!0)])])],64)}}});export{Xe as default};
