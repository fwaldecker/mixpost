import{i as b,D as C,l as B,a4 as J,c as V,o as f,a as t,w as e,k as r,t as o,u as A,x as D,b as a,P as K,y as S,m as L,Q as W,F as U,n as z,q as X,h as x,r as Y,e as k,aa as Z,a3 as j,v as ee,W as te,V as O,a0 as E,a1 as q,d as ae,g as se,S as N,z as oe,j as le,_ as R,ab as re}from"./app-C7yQ4yxP.js";import{_ as ne}from"./Admin-2kdh7iq6.js";import{_ as ce}from"./PageHeader-L61bBZJ1.js";import{_ as P}from"./Panel-DHnLtGhx.js";import{T as F}from"./Trash-TUAkcl9a.js";import{_ as ie}from"./NoResult-BiKMAkVj.js";import{_ as ue}from"./DropdownButton-DdQamZC7.js";import{T as de,a as T,_ as d}from"./TableCell-Do7VWhok.js";import{_ as I,a as M}from"./CanApprove-pAzJJClS.js";import{E as me}from"./Eye-16K59JCb.js";import{_ as pe}from"./PureButtonLink-PaYLzY0E.js";import{_ as Q}from"./VerticalGroup-bCSYX3yy.js";import{A as fe}from"./ArrowTopRightOnSquare-509xbi7A.js";import{_ as _e}from"./ClipboardCard-BnkRhqf1.js";import"./QueueList-DM6iDr1_.js";import"./Flex-B0LjVlwe.js";import"./EllipsisVertical-Cfd6Agro.js";import"./Radio-BputZrd1.js";import"./Checkbox-hSITjV1n.js";import"./ClipboardButton-CuDv6fEO.js";import"./Clipboard-C4EFUpKL.js";const ke={class:"relative"},we={__name:"SelectUser",props:{modelValue:{default:null},users:{type:Array,default:[]},exclude:{type:Array,default:[]},filter:{type:Object,default:{}}},emits:["update:modelValue"],setup(n,{emit:s}){const w=n,y=b("routePrefix"),m=C(w.users),c=(l,p)=>{l&&(p(!0),h(p,l))},h=B.throttle((l,p)=>{axios.get(route(`${y}.users.resources.items`),{params:Object.assign({keyword:p,exclude:w.exclude},w.filter)}).then(_=>{l(!1),m.value=_.data.data.map(v=>({key:v.id,label:v.name}))})},350);return(l,p)=>{const _=J("v-select");return f(),V("div",ke,[t(_,{modelValue:n.modelValue,"onUpdate:modelValue":p[0]||(p[0]=v=>l.$emit("update:modelValue",v)),options:m.value,filterable:!1,"close-on-select":!0,placeholder:l.$t("user.type_search_user"),onSearch:c},{"no-options":e(({search:v,searching:g,loading:i})=>[r(o(l.$t("general.list_empty")),1)]),_:1},8,["modelValue","options","placeholder"])])}}},he={__name:"AttachUser",props:{workspace:{type:Object},attachedUsers:{type:Array,default:[]}},setup(n){const{t:s}=A(),{notify:w}=z(),y=n,m=C(null),c=D({user_id:null,role:"admin",can_approve:!1}),h=()=>{c.transform(v=>({...v,user_id:m.value.key})).post(route("mixpost.workspaces.users.store",{workspace:y.workspace.uuid}),{preserveScroll:!0,onSuccess(){_(),c.reset(),w("success",s("team.user_attached"))}})},l=C(!1),p=()=>{l.value=!0},_=()=>{l.value=!1,m.value=null};return(v,g)=>(f(),V(U,null,[t(S,{onClick:p,size:"sm"},{icon:e(()=>[t(K)]),default:e(()=>[r(" "+o(a(s)("team.attach")),1)]),_:1}),t(W,{show:l.value,"max-width":"md","scrollable-body":!0,closeable:!0,onClose:_},{header:e(()=>[r(o(a(s)("team.attach_user")),1)]),body:e(()=>[t(we,{modelValue:m.value,"onUpdate:modelValue":g[0]||(g[0]=i=>m.value=i),exclude:n.attachedUsers},null,8,["modelValue","exclude"]),t(I,{modelValue:a(c).role,"onUpdate:modelValue":g[1]||(g[1]=i=>a(c).role=i),class:"mt-lg"},null,8,["modelValue"]),t(Q,{class:"mt-lg"},{default:e(()=>[t(M,{modelValue:a(c).can_approve,"onUpdate:modelValue":g[2]||(g[2]=i=>a(c).can_approve=i)},null,8,["modelValue"])]),_:1})]),footer:e(()=>[t(S,{onClick:_,class:"mr-xs rtl:mr-0 rtl:ml-xs"},{default:e(()=>[r(o(a(s)("general.cancel")),1)]),_:1}),t(L,{onClick:h,disabled:!m.value||a(c).processing,isLoading:a(c).processing},{default:e(()=>[r(o(a(s)("team.attach")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"])],64))}},ve={class:"flex justify-start"},ge={class:"capitalize"},$e={class:"flex justify-end"},ye={class:"font-medium"},xe={__name:"WorkspaceUsers",props:{workspace:{type:Object}},setup(n){const{t:s}=A(),w=b("routePrefix"),y=b("confirmation"),{notify:m}=z(),c=n,h=C(null),l=D({user_id:null,role:"admin",can_approve:!1}),p=i=>{l.user_id=i.id,l.role=i.pivot.role,l.can_approve=i.pivot.can_approve,h.value=i},_=()=>{h.value=null,l.reset()},v=i=>{y().title("Detach user").description(`Are you sure you want to detach <strong>${i.name}</strong> from <strong>${c.workspace.name}</strong>?`).destructive().btnConfirmName(s("general.detach")).onConfirm($=>{$.isLoading(!0),q.delete(route("mixpost.workspaces.users.delete",{workspace:c.workspace.uuid}),{data:{user_id:i.id},preserveScroll:!0,onSuccess(){$.reset(),m("success",s("team.user_detached"))},onFinish(){$.isLoading(!1)}})}).show()},g=()=>{l.put(route("mixpost.workspaces.users.update",{workspace:c.workspace.uuid}),{preserveScroll:!0,onSuccess(){l.reset(),_(),m("success",s("team.role_updated"))}})};return(i,$)=>{const G=X("tooltip");return f(),V(U,null,[t(P,null,{title:e(()=>[r(o(a(s)("user.users")),1)]),action:e(()=>[t(he,{workspace:n.workspace,attachedUsers:n.workspace.users.map(u=>u.id)},null,8,["workspace","attachedUsers"])]),default:e(()=>[n.workspace.users.length?(f(),x(de,{key:0},{head:e(()=>[t(T,null,{default:e(()=>[t(d,{component:"th",scope:"col"}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("general.name")),1)]),_:1}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("general.email")),1)]),_:1}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("team.role")),1)]),_:1}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("team.can_approve")),1)]),_:1}),t(d,{component:"th",scope:"col"},{default:e(()=>[r(o(a(s)("team.attached_at")),1)]),_:1}),t(d,{component:"th",scope:"col"})]),_:1})]),body:e(()=>[(f(!0),V(U,null,Y(a(B.sortBy)(n.workspace.users,"pivot.joined_at"),u=>(f(),x(T,{key:n.workspace.id,hoverable:!0},{default:e(()=>[t(d,{align:"left"},{default:e(()=>[k("div",ve,[t(Z,{name:u.name},null,8,["name"])])]),_:2},1024),t(d,null,{default:e(()=>[r(o(u.name),1)]),_:2},1024),t(d,null,{default:e(()=>[r(o(u.email),1)]),_:2},1024),t(d,null,{default:e(()=>[t(j,null,{default:e(()=>[k("span",ge,o(a(s)(`team.${u.pivot.role}`)),1)]),_:2},1024)]),_:2},1024),t(d,null,{default:e(()=>[u.pivot.can_approve?(f(),x(j,{key:1,variant:"info"},{default:e(()=>[r(o(a(s)("general.yes")),1)]),_:1})):(f(),x(j,{key:0},{default:e(()=>[r(o(a(s)("general.no")),1)]),_:1}))]),_:2},1024),t(d,null,{default:e(()=>[r(o(u.pivot.joined_at),1)]),_:2},1024),t(d,{align:"right"},{default:e(()=>[k("div",$e,[ee((f(),x(pe,{href:i.route(`${a(w)}.users.view`,{user:u.id}),class:"mr-xs"},{default:e(()=>[t(me)]),_:2},1032,["href"])),[[G,a(s)("general.view")]]),t(te,{placement:"bottom-end"},{trigger:e(()=>[t(ue)]),content:e(()=>[t(O,{onClick:H=>p(u),as:"button"},{icon:e(()=>[t(E)]),default:e(()=>[r(" "+o(a(s)("team.edit_role")),1)]),_:2},1032,["onClick"]),t(O,{onClick:H=>v(u),as:"button"},{icon:e(()=>[t(F,{class:"text-red-500"})]),default:e(()=>[r(" "+o(a(s)("general.detach")),1)]),_:2},1032,["onClick"])]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1})):(f(),x(ie,{key:1}))]),_:1}),t(W,{show:h.value!==null,"max-width":"md","scrollable-body":!0,closeable:!0,onClose:_},{header:e(()=>[k("span",null,[r(o(a(s)("team.edit_role_for"))+" ",1),k("span",ye,o(h.value.name),1)])]),body:e(()=>[t(I,{modelValue:a(l).role,"onUpdate:modelValue":$[0]||($[0]=u=>a(l).role=u),class:"mt-xs"},null,8,["modelValue"]),t(Q,{class:"mt-lg"},{default:e(()=>[t(M,{modelValue:a(l).can_approve,"onUpdate:modelValue":$[1]||($[1]=u=>a(l).can_approve=u)},null,8,["modelValue"])]),_:1})]),footer:e(()=>[t(S,{onClick:_,class:"mr-xs"},{default:e(()=>[r(o(a(s)("general.cancel")),1)]),_:1}),t(L,{onClick:g,disabled:a(l).processing,isLoading:a(l).processing},{default:e(()=>[r(o(a(s)("general.update")),1)]),_:1},8,["disabled","isLoading"])]),_:1},8,["show"])],64)}}},be={class:"w-full mx-auto row-py"},Ve={class:"flex items-center"},Ce={class:"row-px"},Se={class:"mt-lg"},Ue=ae({layout:ne}),Ke=Object.assign(Ue,{__name:"View",props:{workspace:{type:Object}},setup(n){const{t:s}=A(),w=b("routePrefix"),y=b("confirmation"),m=n,{notify:c}=z(),h=()=>{y().title(s("workspace.delete_workspace")).description(s("workspace.confirm_delete_workspace")).destructive().onConfirm(l=>{l.isLoading(!0),q.delete(route(`${w}.workspaces.delete`,{workspace:m.workspace.uuid}),{onSuccess(){c("success",s("workspace.workspace_deleted"))}})}).show()};return(l,p)=>(f(),V(U,null,[t(a(se),{title:a(s)("workspace.view_workspace")},null,8,["title"]),k("div",be,[t(ce,{title:a(s)("workspace.view_workspace")},{description:e(()=>[r(o(n.workspace.name),1)]),default:e(()=>[k("div",Ve,[t(a(N),{href:l.route("mixpost.switchWorkspace",{workspace:n.workspace.uuid,redirect:!0}),method:"post",as:"button",type:"button",class:"mr-xs rtl:mr-0 rtl:ml-xs"},{default:e(()=>[t(S,{size:"sm"},{icon:e(()=>[t(fe)]),default:e(()=>[r(" "+o(a(s)("general.open")),1)]),_:1})]),_:1},8,["href"]),t(a(N),{href:l.route(`${a(w)}.workspaces.edit`,{workspace:n.workspace.uuid}),class:"mr-xs rtl:mr-0 rtl:ml-xs"},{default:e(()=>[t(L,{size:"sm"},{icon:e(()=>[t(E)]),default:e(()=>[r(" "+o(a(s)("general.edit")),1)]),_:1})]),_:1},8,["href"]),t(oe,{onClick:h,size:"sm"},{icon:e(()=>[t(F)]),_:1})])]),_:1},8,["title"]),k("div",Ce,[t(P,null,{title:e(()=>[r(o(a(s)("general.details")),1)]),default:e(()=>[t(R,null,{title:e(()=>[r(o(a(s)("general.name")),1)]),default:e(()=>[k("div",null,o(n.workspace.name),1)]),_:1}),t(R,{class:"mt-lg"},{title:e(()=>[r(o(a(s)("general.color")),1)]),default:e(()=>[k("div",{style:re({background:n.workspace.hex_color}),class:"w-xl h-xl rounded-md"},null,4)]),_:1})]),_:1}),k("div",Se,[t(xe,{workspace:n.workspace},null,8,["workspace"])]),l.$page.props.mixpost.features.api_access_tokens?(f(),x(P,{key:0,class:"mt-lg"},{title:e(()=>[r(o(a(s)("system.usage_api")),1)]),default:e(()=>[t(_e,null,{default:e(()=>[r(o(n.workspace.uuid),1)]),_:1})]),_:1})):le("",!0)])])],64))}});export{Ke as default};
